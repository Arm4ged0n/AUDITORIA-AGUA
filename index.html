<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HIDROSANDRO - Professional Audit</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@300;400;600;800;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --neon-blue: #00f2ff;
            --neon-purple: #bc13fe;
            --dark-bg: #030712;
            --card-bg: rgba(17, 24, 39, 0.7);
        }

        body { 
            font-family: 'Inter', sans-serif; 
            background-color: var(--dark-bg); 
            color: #e2e8f0; 
            margin: 0;
            background-image: 
                radial-gradient(circle at 50% 0%, rgba(0, 242, 255, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 100% 100%, rgba(188, 19, 254, 0.05) 0%, transparent 50%);
            background-attachment: fixed;
        }

        .mono { font-family: 'JetBrains Mono', monospace; }

        .neon-border {
            border: 1px solid rgba(0, 242, 255, 0.2);
            box-shadow: 0 0 15px rgba(0, 242, 255, 0.05);
            transition: all 0.3s ease;
        }

        .neon-border:hover {
            border-color: var(--neon-blue);
            box-shadow: 0 0 20px rgba(0, 242, 255, 0.15);
        }

        .neon-text {
            text-shadow: 0 0 10px rgba(0, 242, 255, 0.5);
        }

        .glass-panel {
            background: var(--card-bg);
            backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .gradient-text {
            background: linear-gradient(to right, #00f2ff, #bc13fe);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #1e293b; border-radius: 10px; }

        @keyframes scanline {
            0% { transform: translateY(-100%); }
            100% { transform: translateY(100%); }
        }

        .scanline {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 2px;
            background: rgba(0, 242, 255, 0.1);
            animation: scanline 4s linear infinite;
            pointer-events: none;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo, useEffect } = React;

        // Ícones Lucide-like customizados
        const IconChart = () => <svg size="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 3v18h18"/><path d="m19 9-5 5-4-4-3 3"/></svg>;
        const IconDroplet = () => <svg size="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M12 22a7 7 0 0 0 7-7c0-2-1-3.9-3-5.5s-3.5-4-4-6.5c-.5 2.5-2 4.9-4 6.5s-3 3.5-3 5.5a7 7 0 0 0 7 7z"/></svg>;
        const IconDollar = () => <svg size="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>;
        const IconSettings = () => <svg size="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.1a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/><circle cx="12" cy="12" r="3"/></svg>;

        const App = () => {
            const LEITURA_FECHAMENTO = 28.282; 
            const TAXA_FIXA = 39.32;
            const VALOR_AGUA_22M3 = 193.78; 
            const PRECO_POR_M3 = VALOR_AGUA_22M3 / 22;

            const [logs, setLogs] = useState(() => {
                const salvo = localStorage.getItem('hidrosandro_pro_v1');
                return salvo ? JSON.parse(salvo) : [
                    { id: 1, valor: 28.512, timestamp: Date.now() },
                    { id: 0, valor: 28.387, timestamp: Date.now() - 86400000 }
                ];
            });

            const [input, setInput] = useState('');

            useEffect(() => {
                localStorage.setItem('hidrosandro_pro_v1', JSON.stringify(logs));
            }, [logs]);

            const stats = useMemo(() => {
                const atual = logs.length > 0 ? logs[0].valor : LEITURA_FECHAMENTO;
                const consumidoLitros = Math.max(0, Math.round((atual - LEITURA_FECHAMENTO) * 1000));
                
                let mediaL = 733; 
                if (logs.length > 1) {
                    const diffM3 = logs[0].valor - logs[logs.length - 1].valor;
                    const diffDias = (logs[0].timestamp - logs[logs.length - 1].timestamp) / (1000 * 60 * 60 * 24);
                    if (diffDias > 0.05) mediaL = Math.round((diffM3 * 1000) / diffDias);
                }
                
                const projecao30DiasM3 = (mediaL * 30) / 1000;
                const faturaEstimada = TAXA_FIXA + (projecao30DiasM3 * PRECO_POR_M3);

                // Dados para o mini gráfico
                const chartPoints = [...logs].reverse().map((l, i) => {
                    const lConsumo = Math.round((l.valor - LEITURA_FECHAMENTO) * 1000);
                    return lConsumo;
                });

                return {
                    atual, consumidoLitros, mediaL, faturaEstimada,
                    totalCiclos: Math.floor(consumidoLitros / 100),
                    sobraCiclo: consumidoLitros % 100,
                    chartPoints
                };
            }, [logs]);

            const salvar = () => {
                const val = parseFloat(input);
                if (isNaN(val)) return;
                const novo = { id: Date.now(), valor: val, timestamp: Date.now() };
                setLogs([novo, ...logs]);
                setInput('');
            };

            const MiniChart = ({ data }) => {
                if (data.length < 2) return <div className="h-full w-full flex items-center justify-center text-[10px] text-slate-600">DADOS INSUFICIENTES</div>;
                const max = Math.max(...data);
                const min = Math.min(...data);
                const range = max - min || 1;
                const points = data.map((d, i) => {
                    const x = (i / (data.length - 1)) * 100;
                    const y = 100 - ((d - min) / range) * 80 - 10;
                    return `${x},${y}`;
                }).join(' ');

                return (
                    <svg className="w-full h-full" viewBox="0 0 100 100" preserveAspectRatio="none">
                        <defs>
                            <linearGradient id="grad" x1="0" y1="0" x2="0" y2="1">
                                <stop offset="0%" stopColor="#00f2ff" stopOpacity="0.3" />
                                <stop offset="100%" stopColor="#00f2ff" stopOpacity="0" />
                            </linearGradient>
                        </defs>
                        <path d={`M 0,100 L ${points} L 100,100 Z`} fill="url(#grad)" />
                        <polyline points={points} fill="none" stroke="#00f2ff" strokeWidth="2" strokeLinejoin="round" />
                    </svg>
                );
            };

            return (
                <div className="min-h-screen p-4 md:p-8 max-w-5xl mx-auto flex flex-col gap-6 relative">
                    <div className="scanline"></div>
                    
                    {/* Top Bar Navigation Style */}
                    <header className="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 glass-panel p-6 rounded-2xl neon-border">
                        <div className="flex items-center gap-4">
                            <div className="w-12 h-12 bg-slate-900 rounded-lg flex items-center justify-center border border-cyan-500/30 shadow-[0_0_15px_rgba(0,242,255,0.2)]">
                                <span className="text-cyan-400"><IconDroplet /></span>
                            </div>
                            <div>
                                <h1 className="text-2xl font-black tracking-tighter italic gradient-text">HIDROSANDRO <span className="text-[10px] font-mono not-italic text-slate-500 ml-2 tracking-widest">v2.0 PRO</span></h1>
                                <div className="flex items-center gap-2 text-[10px] mono text-slate-400">
                                    <span className="w-2 h-2 rounded-full bg-cyan-500 animate-pulse"></span>
                                    SISTEMA DE AUDITORIA OPERACIONAL • NOVA HARTZ
                                </div>
                            </div>
                        </div>
                        <div className="flex gap-3">
                            <div className="text-right hidden sm:block">
                                <p className="text-[10px] font-bold text-slate-500 uppercase">Status do Sensor</p>
                                <p className="text-xs font-mono text-cyan-400">HIDRÔMETRO SINCRONIZADO</p>
                            </div>
                            <button className="p-3 bg-slate-800 rounded-lg hover:bg-slate-700 text-slate-400 transition-colors border border-white/5">
                                <IconSettings />
                            </button>
                        </div>
                    </header>

                    {/* Main Dashboard Grid */}
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                        
                        {/* Financial Card (Power BI Style) */}
                        <div className="md:col-span-2 glass-panel p-8 rounded-3xl neon-border relative overflow-hidden group">
                            <div className="absolute top-0 right-0 p-8 opacity-10 group-hover:opacity-20 transition-opacity">
                                <IconDollar />
                            </div>
                            <div className="relative z-10 flex flex-col h-full justify-between">
                                <div>
                                    <p className="text-[11px] font-black text-cyan-500/80 uppercase tracking-[0.2em] mb-1">Projeção de Fatura Mensal</p>
                                    <h2 className="text-6xl font-black italic text-white tracking-tighter neon-text mb-4">
                                        R$ {stats.faturaEstimada.toLocaleString('pt-BR', {minimumFractionDigits: 2})}
                                    </h2>
                                    <div className="flex flex-wrap gap-4">
                                        <div className="bg-cyan-500/10 border border-cyan-500/20 px-3 py-1 rounded-full flex items-center gap-2">
                                            <span className="w-1.5 h-1.5 rounded-full bg-cyan-500"></span>
                                            <span className="text-[10px] font-bold text-cyan-400 mono">MÉDIA: {stats.mediaL}L/DIA</span>
                                        </div>
                                        <div className="bg-purple-500/10 border border-purple-500/20 px-3 py-1 rounded-full flex items-center gap-2">
                                            <span className="w-1.5 h-1.5 rounded-full bg-purple-500"></span>
                                            <span className="text-[10px] font-bold text-purple-400 mono">BASE: 22m³ CORSAN</span>
                                        </div>
                                    </div>
                                </div>
                                <div className="mt-8 h-24 w-full">
                                    <MiniChart data={stats.chartPoints} />
                                </div>
                            </div>
                        </div>

                        {/* Operative Stats */}
                        <div className="flex flex-col gap-6">
                            <div className="glass-panel p-6 rounded-3xl border border-white/5 flex flex-col justify-between">
                                <div className="flex justify-between items-start mb-4">
                                    <p className="text-[10px] font-bold text-slate-500 uppercase tracking-widest">Leitura Atual</p>
                                    <div className="px-2 py-0.5 bg-green-500/20 text-green-400 text-[8px] font-black rounded uppercase">Online</div>
                                </div>
                                <p className="text-4xl font-mono font-bold text-white tracking-tighter">
                                    {stats.atual.toFixed(3)}<span className="text-lg text-slate-600 ml-1">m³</span>
                                </p>
                            </div>
                            
                            <div className="glass-panel p-6 rounded-3xl border border-white/5 bg-gradient-to-br from-slate-900/50 to-cyan-900/10">
                                <div className="flex items-center gap-3 mb-4">
                                    <div className="p-2 bg-cyan-500/20 rounded-lg text-cyan-400"><IconChart /></div>
                                    <p className="text-[10px] font-bold text-slate-400 uppercase tracking-widest">Volume Acumulado</p>
                                </div>
                                <p className="text-4xl font-black italic text-white tracking-tighter">
                                    {stats.consumidoLitros}<span className="text-lg opacity-40 ml-1">LITROS</span>
                                </p>
                                <div className="mt-4 pt-4 border-t border-white/5">
                                    <p className="text-[9px] font-bold text-slate-500 uppercase mb-2">Progresso do Ciclo (100L)</p>
                                    <div className="w-full h-1.5 bg-slate-950 rounded-full overflow-hidden">
                                        <div 
                                            className="h-full bg-gradient-to-right from-cyan-500 to-blue-500 shadow-[0_0_10px_rgba(0,242,255,0.5)] transition-all duration-700" 
                                            style={{ width: `${stats.sobraCiclo}%` }}
                                        ></div>
                                    </div>
                                    <div className="flex justify-between mt-2 text-[9px] mono text-cyan-500/70">
                                        <span>{stats.totalCiclos} ciclos</span>
                                        <span>{stats.sobraCiclo}L/100L</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* Data Entry & History */}
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-6 pb-20">
                        {/* Input Panel */}
                        <div className="glass-panel p-8 rounded-3xl neon-border border-l-4 border-l-cyan-500">
                            <h3 className="text-xs font-black text-white uppercase tracking-widest mb-6 flex items-center gap-2">
                                <span className="w-2 h-2 bg-cyan-500 rounded-full"></span>
                                Registrar Telemetria
                            </h3>
                            <div className="space-y-4">
                                <div className="relative group">
                                    <input 
                                        type="number" 
                                        inputMode="decimal"
                                        placeholder="00.000"
                                        value={input}
                                        onChange={e => setInput(e.target.value)}
                                        className="w-full bg-slate-950/50 border border-white/10 rounded-xl p-4 text-3xl font-mono font-bold text-cyan-400 outline-none focus:border-cyan-500/50 focus:bg-slate-950 transition-all text-center"
                                    />
                                    <div className="absolute inset-0 rounded-xl bg-cyan-500/5 opacity-0 group-focus-within:opacity-100 pointer-events-none transition-opacity"></div>
                                </div>
                                <button 
                                    onClick={salvar}
                                    className="w-full bg-cyan-600 hover:bg-cyan-500 text-slate-950 font-black py-4 rounded-xl uppercase text-xs tracking-[0.2em] transition-all transform active:scale-95 shadow-lg shadow-cyan-900/20"
                                >
                                    Atualizar Dashboard
                                </button>
                            </div>
                        </div>

                        {/* Audit Table */}
                        <div className="md:col-span-2 glass-panel rounded-3xl border border-white/5 overflow-hidden">
                            <div className="p-6 border-b border-white/5 flex justify-between items-center bg-white/5">
                                <h3 className="text-[10px] font-black text-slate-400 uppercase tracking-widest italic">Logs de Auditoria de Campo</h3>
                                <span className="text-[10px] mono text-slate-500 uppercase">Últimos 5 registros</span>
                            </div>
                            <div className="overflow-x-auto">
                                <table className="w-full text-left">
                                    <thead>
                                        <tr className="text-[9px] font-bold text-slate-600 uppercase mono border-b border-white/5">
                                            <th className="p-4">Timestamp</th>
                                            <th className="p-4">Medição (m³)</th>
                                            <th className="p-4">Consumo (L)</th>
                                            <th className="p-4 text-center">Ações</th>
                                        </tr>
                                    </thead>
                                    <tbody className="divide-y divide-white/5 text-sm mono">
                                        {logs.slice(0, 5).map(log => (
                                            <tr key={log.id} className="hover:bg-white/5 transition-colors group">
                                                <td className="p-4 text-slate-400">
                                                    {new Date(log.timestamp).toLocaleDateString('pt-BR')} <span className="text-[10px] opacity-40">{new Date(log.timestamp).toLocaleTimeString('pt-BR', {hour:'2-digit', minute:'2-digit'})}</span>
                                                </td>
                                                <td className="p-4 font-bold text-white italic">{log.valor.toFixed(3)}</td>
                                                <td className="p-4">
                                                    <span className="text-cyan-500/80 font-bold">{Math.round((log.valor - LEITURA_FECHAMENTO)*1000)}L</span>
                                                </td>
                                                <td className="p-4 text-center">
                                                    <button 
                                                        onClick={() => setLogs(logs.filter(l => l.id !== log.id))}
                                                        className="p-2 text-slate-700 hover:text-red-400 transition-colors"
                                                    >
                                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2"><path d="M3 6h18m-2 0v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6m3 0V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/></svg>
                                                    </button>
                                                </td>
                                            </tr>
                                        ))}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
